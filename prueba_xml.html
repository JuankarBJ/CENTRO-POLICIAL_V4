<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Generación XML</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f4f9; padding-top: 40px; }
        .container { max-width: 600px; }
        .card-header { background-color: #0d6efd; color: white; }
    </style>
</head>
<body>

    <div class="container">
        <div class="card shadow-sm">
            <div class="card-header">
                <h3 class="mb-0">Prueba de Generación XML</h3>
            </div>
            <div class="card-body">
                <p>Rellena estos campos para generar un archivo <code>datos_prueba.xml</code>.</p>
                <form id="xml-form">
                    <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre (Texto)</label>
                        <input type="text" class="form-control" id="nombre" value="Juan Pérez">
                    </div>
                    <div class="mb-3">
                        <label for="edad" class="form-label">Edad (Número)</label>
                        <input type="number" class="form-control" id="edad" value="45">
                    </div>
                    <div class="mb-3">
                        <label for="fecha" class="form-label">Fecha (Fecha)</label>
                        <input type="date" class="form-control" id="fecha" value="2025-11-17">
                    </div>
                    <div class="mb-3">
                        <label for="obs" class="form-label">Observaciones (Textarea)</label>
                        <textarea class="form-control" id="obs" rows="3">Línea 1
Línea 2 (con tildes)</textarea>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Generar y Descargar XML</button>
                </form>
            </div>
        </div>
    </div>

<script>
    // 1. "Escuchar" el envío del formulario
    document.getElementById('xml-form').addEventListener('submit', function(e) {
        e.preventDefault(); // Evitar que la página se recargue

        // 2. Obtener los valores
        const nombre = document.getElementById('nombre').value;
        const edad = document.getElementById('edad').value;
        const fecha = document.getElementById('fecha').value;
        const obs = document.getElementById('obs').value;

        // 3. Construir el string XML
        // Esta es la parte clave. Es un texto plano que sigue un formato.
        const xmlContent = `<?xml version="1.0" encoding="UTF-8"?>
<datos>
    <nombre>${nombre}</nombre>
    <edad>${edad}</edad>
    <fecha>${fecha}</fecha>
    <observaciones>${obs}</observaciones>
</datos>`;

        // 4. Llamar a la función de descarga
        downloadXML(xmlContent, 'datos_prueba.xml');
    });

    /**
     * Función para descargar un archivo de texto como XML
     */
    function downloadXML(xmlContent, filename) {
        // Creamos un "Blob" (un archivo virtual)
        // El tipo 'text/xml' es el estándar para XML.
        const blob = new Blob([xmlContent], { type: 'text/xml;charset=utf-8;' });
        
        // Creamos un enlace invisible
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        
        link.setAttribute("href", url);
        link.setAttribute("download", filename);
        link.style.visibility = 'hidden';
        
        // Simulamos el clic
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
</script>

</body>
</html>